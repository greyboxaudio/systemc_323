#include "rom8.h"

const sc_uint<8> data[256] = {
228,228,228,229,229,197,229,229,229,229,229,197,229,229,229,229,197,229,229,229,197,229,229,229,197,229,229,197,229,229,197,229,133,165,229,229,229,197,229,229,229,197,229,229,229,197,229,229,229,197,229,229,197,229,229,197,229,229,213,245,117,85,117,125,251,155,163,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,115,115,123,123,255,251,227,243,243,243,251,251,255,251,227,243,243,243,251,251,255,251,227,243,243,243,251,251,255,251,227,243,243,243,251,251,255,251,227,243,243,243,251,251,255,251,227,243,243,243,251,251,255,251,227,243,243,243,251,251,255,251,227,243,243,243,251,251,255,251,227,243,243,243,251,251,255,251,227,227,235,226,194,226
};

// FIR Main thread
// scoping module::thread; fir_main is within the scope of module fir
//(void) as argument to show explicitely that fir_main has no arguments
void rom8::rom8_main(void)
{
    inp_rdy.write(0);
    outp_vld.write(0);
    outp.write(0);
    wait();

    while (true)
    {
        sc_uint<8> in_val;
        sc_uint<8> out_val;
        // handshake
        inp_rdy.write(1);
        do
        {
            wait();
        } while (!inp_vld.read());

        in_val = inp.read(); // read input
        inp_rdy.write(0);

            out_val += data[in_val];
        // handshake
        outp_vld.write(1);
        outp.write(out_val); // write output
        do
        {
            wait();
        } while (!outp_rdy.read());
        outp_vld.write(0);
    }
}